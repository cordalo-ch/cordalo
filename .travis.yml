env:
  global:
    - #  to update first run: travis login
    - # GITHUB_SECRET_TOKEN, created with travis encrypt "GITHUB_SECRET_TOKEN=xxxxxx"
    - secure: "Us+a8H+yRA6qppLPjx/+GqIAhuE1m5OLuxbSvez0S3a2Ib8+VRG54esqCrV0jQiZKlY1T2F5qnaJn+li06YNaW0MrKueSQHz/oUXaA6zSnGETTq57J1L5Fy1a0qhtn5ipA1GTKg8/B5WhhVye+N1pU4Z13m0efDoJ/SgYTr762Eg2vpcvkaZRfA03gH+5ZQxMg4MbXXENQDi0WAl+HefXCJTiAJjjq5i5cK00w9ELpDz1x4uLjgb6idXh17vUXGXgSA6CBDJgAXGZBsM/VrAiggQDwLbYr4Qddd6/feEU8cdqi6rc8X7FQCgzQp0qLbQT7NTLH8kot9z8hlc/BgXC8k9VCAdXMdH1Jw6vfhZlfKcRoixpue0uoXU7Cv1wyvsb2krGoZCamGNoTZ+v05+ObxHeUzDgFz000XUyhLCsZ+yfv8BBL5r2E4gSWx99kF/GJsuqZwEkxuJokjsWPomBugScIwsKoIerW2mK2WXJq2vwtg3EveJ0TdERCWg3XxsRS2kugxnf+71rDLlqRn7h9gojYMPpjOCwS39GURr5nDdyY0MjmCxpTwJTinzXU4vGi7qI/9rCXkAjXNWSDz32lXOVe8ysiaAhxJ5xX1Om5mZclHdc8mD18r6t5z42CSRhOJM6vmJ2WnKQ15RbDGL4G5xidFPhFuPbHX8ulUSD5Q="
    - # SONATYPE_USERNAME, created with travis encrypt "SONATYPE_USERNAME=xxxxxx"
    - secure: "aU0yptfM8xH0mXbUDYv8YDkORo6s07kLU1ek5rzfT4l/zNszVGpbO6vKpSk0OzIzgvRmYDMagKRSgl7juWThDkYYGlfn0Kc3ku9bw3VNKFyEtEMmaFtEuzTXMgXo9OtVhzOqVo3S+Ys0pqMaznYPsNmHXulBVttJ8Tw97P0D0rOyIq6ecAEUUVURhzYV34QDtqQv84iVTMN+WP57X8b1UL6v+pzk4lGI487xm+GLVdUYmIZThbfxZZzLBo+fOwXyU5qkH6563bzwvhs3XGg0hARhlrAEIKPubT0mQeAEOSbQJZQqMOMXtJ6EaIlwmbc/dXCTo1fWVR1Qy80XdHtx5HOOa2gRp82hm0iRlOymjzmpNmKVZMo4AitT+GPEIizN5G80D3+Ky9reg6cgmcrM2JFwxgIOgQh8PS0yBwk1U1KX4veLYonXRgnNM7NLDRdMY//ca/9/TUZ1p0oH5LKYOnxrrePPUNt/beHeAd3LKdyLxJTKBBSXNdyh+jGHFJw764C0Zj0zPPKBKZDryCuvfGSSZTl2aqksgXY+4XtL9TV6m7w3c/IZpPTkclPKR+jtJuaEUgF5J7s9Uunlf/GcgMck11BRNIDiYiOFjYPW8GXkRqlGH9grZyzob0PY/1EwebGjq5AmxDbNqgEfOtPO3y8XKbD5fEIHIcRU3x4qtXA="
    - # SONATYPE_PASSWORD, created with travis encrypt "SONATYPE_PASSWORD=xxxxxx"
    - secure: "YW+HL4ixyCCqtWZXpA1Wd+N4hf/7qKsOi139kzOJ8h32FnetPaf3dkynjzMlk7yE/8d2z/MAdqb+P/rks6aP0feJWiqGcTycrtbXi/upRlwsqK7/Woitczy5D236NAhELkMjmlRrAjYis4/oofNxvVqJ0s+BX1V2BNrLzsw34iRlYeikWxq5XvW/hacmj23ufH+iiZZrXemWXi6F5bpBOb871o61CyFdYlOXkcf7L6hOM07azusn1h7KWI41oV03+4PjZ3eVvhp4o3/nrcN1VaZLu4ajlUNx4cQnt1dm15N/eksZORVz+R9Stm961ZPGg/7zKVSzAQ9DMd1JpQn1U/pb1J9yOpzwIHEZpoUUdJCxv6fskG2AQ1LMOTMyO0WLTwT2n3WvZ2oJfdkY2LQMHeUAGVzmt1jYHpyqzXlDGamIMrePKShP6juN7Axc53S9mpL+s/R1mRMjpcJfw9ychulYvqhYuf886Xe9C1p0n4uJYQTutGKzJloVWazOsSE3yIHF4ZS9Rt9OL6aa86TPLD/Kj4/WhriH/Ws9ZsMm7U/Czti/UbZY2XG4R6mVs/uDqlIBvnxHEVUKr+a6qmotl4rLCuqrpL+m6M39bU6gPTdiqDMotXojW1HQxXmgFs4SRhL/bxOHiQxaNTM4JotHJJLNvR+R67Gu3i5sY2usScY="
    - # GPG_KEY_ID, created with travis encrypt "GPG_KEY_ID=xxxxxx"
    - secure: "ZQlCYILzUvQglGDUsSxo5C1RE8AqwbfDZVgekbIazXTjtQwe8Y2C1/mIPPrcz47nEWXfKoXhV4RM8SEsA7gTWZIz8DtsnutQnakWuKimK4Q/+SVu8e8eFyzCYIxceznnxn618ru6VUDO3HyyhZQ+5vXpFNUenKpTwizLsqgXGAEAxKTphqlQufAmDqRKAHHIhy6Uhrt7dBmAi4yGRGHZ3S05D/TOUpVwyh4kt2TvtHfUiE7kXUmB15EB93CxEdY9ftvAFLohHwohjdPtsDQ1cQiiYoDzYalaj3SYY3lFlsOCqOoNi2qWzQYHrRbZ21nZz84FGbCK16Q3AgnFePBXnl8Uer70eyG/YNrsnWQO9tyu3B8/ZnnC1mTG1uRiOrQK0zdNaQVOapFjJiHVWumnvUlzXdpssUmIYy9oQz6ZBEHTsOPYs1EwUMhJ0pK8Xcbxz9mRqZgpkL1IvKkq+bSDQu7br9tayhlwnvaJ6UZWQOYx8y4Qy/m18BKst+qP/ta2VC7QwXZQetsTSGHZ+HRA+Phkxy78TrpCrGbIx01CQYaAULCvSh6qseGimR89ORzkWPL8M1EQ+lneg7E5hwjW0irigVmL60nYj+jOw4T9w7KSVRpyAuY96uWWpL7f5ACn6jzpWuilJXEJDm3kM2Cjr11sD+4AQS8GpfnOgqCfZBo="
    - # GPG_PASSPHRASE, created with travis encrypt "GPG_PASSPHRASE=xxxxxx"
    - secure: "q4ngDsMWdJPr2FZK2vYO4WKAiZBc8pP+Er8BmD/7CJWMeRM1u/68F6hEwlxP0UP5nVpaCgPOf1kUKjEwd8NHvjgy3FsQYNNqSAfBuaUdKrMHpN5+GAkwm3HDyfuAkL+8hwdTtiwC54C4F/8DNHkc3n7NZJeOsAlnsfkBjJbXJ/V+VIwYyivnsCRuvE/PwfadJR2VPIgxCMhMGYDxsLEMOcVYBYr5ICs5ez9u85l7Qgjr9ZNfBCMbHkwB62HIbziIpDJgnOL5aGJqYuaTZ2RIizSTAWEfntBlJKmu4oyQCDGjHL38IYj6FeDePNbFbyJ5RwQdLufkoPwzuf0hpIktV5aA64XSBmDUzmFgpaPkhr/eZghzzVp0EY1khHpzBs4iVuf8s8df1AHgcgn+3tQRS2izbZfbtNjUxKltdtPyiSMIz1tFCXVw+Kf82pwhpopkl5k9t+90z3FdA6HUn8fTO9MNu/tXtKDVyTKmrPUK00khMgdShRGpJk+Q6Js351Be9sWJ9Kjx0Io40oBJHscVpyylpnduWRAuxKxbtdc1fNjDA+DatIc2+0JwtmbBhg5wX5OP8/HzDJi9h5Y1vzsa5WAvQFpyANjPc8jZ9vQtZod8C7SPm9i2wdK+knt8q6yJcuIo9u9qtb88qOOVGPOPKl2N6tIIROVsb5M+gSBtnAE="
    - # COVERALLS_REPO_TOKEN, created with travis encrypt "COVERALLS_REPO_TOKEN=xxxxxx"
    - secure: "XglmCPkYT16wE3e0592NuOwu5eY31yCwGAUCHfT2YdEX1A3vnTJKNC9fVntbTQ1GXwwOkasERO0oOaf9sieKG2zNDJY2bFwSMuDNS/XmQNMbXLgRbxVgEfZoUU/R5tjh0mRtlKF6FrJaALM+giSLXc1Q3G6BU2k9N6WC7YV32uyREA/AB5o/NHVYKvl4hgO4Q22AhtdLqoLhdgtY4qB4LCY3KaBusx/6kMclG/BsEIArrO+458YQGS06e45POortmyK5KZuoCSlYh01uKwuP3mnUF5zyUBYIz5SRY6+4hEXWuEFH3vikMOm0ByQRbK6y8zz88jhpRNJ/70WHVyY3jMmHHs8r05vLzLPNVSAKhepwcI03a6w1cr1KWdmaf7mVVnwAfnDgI7r8G7hm83M6aFqHOTHnBK9RDyWMc/5ELIvYuqlG+waFR/mGUhV2jvtQvBusUCDv3pmlpFF1OxKSQY8zP/8bu0Wi1P9aBz4nM1+3DJyqabTStGv7mrTSlZKlhr9209frkExCmxnJfAaP9FDZz1gthgBQgObLgX1VtHMea8nLpFJ2rDVrIqYbn+cxCljmIcHwWT+bfuV0EgTOvUBRFTNzdbEcUydzRCMkPxjhOkMlsZMru1AwS/N0hd3+2GMSsIqtd4B/f0ZLFQzQatZyl8Pdc5qUJ5VWPlJrCrE="
    - GPG_KEY_LOCATION=".travis/secring.gpg"
    - ENCRYPTED_GPG_KEY_LOCATION=".travis/secring.gpg.enc"

#  The branches section lets Travis know which branches to build on. Use master and dev only.
branches:
  only:
    - master
    - dev
os: linux
dist: xenial
language: java
jdk: openjdk8

#  The before_install step runs before the build starts. This is where decrypting the keys will happen.
before_install:
  - chmod -R ug+x .travis
  - .travis/install.sh

#  The script step is the list of build steps. If any step fails, the next ones continue, but the build will be marked as failed.
script:
  - chmod -R ug+x .travis
  - .travis/build.sh
  - .travis/merge-dev-to-master-gate.sh
  - .travis/deploy-gate.sh
  - .travis/tag-master-gate.sh

# allow to publish a new release at https://github.com/cordalo-ch/cordalo/releases
before_deploy:
  - export project_version=$(gradle properties -q | grep "^version:" | awk '{print $2}')
deploy:
  provider: releases
  api_key:
    secure: m4W77KdzMq8RL6SQ/JMnfxoxETh3UEZBiB/Fx1yRfi0mILVZ7+HLtFYOlgnM87hE8rzTZyQuDmz287Pcs4vOAih84js6N1bmHDGYkZ7Y/l+HyWWBa0t5f1q5pP0xK5gl3UuLITmUSgdq6E5scgveY8lFPkuwkzNXK/OLIGNBrnaZboEcjzNFL5AVqHwLsh57fFgnyuAFzfW5eIG5dmBzzCLmIDlvjneCHoipn0xX9jynQteJMAckkPU3rGAqfOxWySsPnNNYSH/jW7FxpHfpXq0wACLwkZlhbjYcPe3v92k4WoPGfJn3AUef1XrhhmzSxP4WEAcEBeMbgcOQCmZyZk2GUzpgFEdaztXlyGUxRtCI3v8OZPPBghuEzDPWvwof6ecNEIilKNad62wltWrZnFQANol+U41ECL9oIecyDpM9q9uVxRdEW/CH90PBG3xVY3fJzTDmPZ/psin6NXKsbkPGCOg4IyT06TEpwt8D0YmVrizzRDpAtfGh2eeVsaeHGau8HKertOq4qymalhq74T7HvKEOxvob+x4vDeBLaB/p7xcxiaYUCFihxhiPEQwvibnNsfNKEsAqZfaZzHcxX27A+VooJ5ruEAqGtOCvQ62Nq1xo63VDokOqJKr/VLtaYBYQ7FLbYpZl0FyNqnBejnaIVbMtiMh/jUu4DohuDVM=
  file: build/libs/cordalo-$project_version.jar
  on:
    repo: cordalo-ch/cordalo
  name: $project_version